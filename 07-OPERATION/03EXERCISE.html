
<!-- saved from url=(0089)http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <title>EXERCISE</title> 
   
  <script type="text/javascript" src="./03EXERCISE_files/jquery.min.js">
    </script> 
  <script type="text/javascript" src="./03EXERCISE_files/jquery.snippet.js">
    </script> 
  <script type="text/javascript" src="./03EXERCISE_files/main.js">
    </script> 
  <link type="text/css" href="./03EXERCISE_files/index.css" rel="Stylesheet"> 
  <link type="text/css" href="./03EXERCISE_files/jquery.snippet.css" rel="Stylesheet"> 
 </head> 
 <body> 
  <div class="source_style_exercise"> 
   <div> 
    <h3>1 Nginx反向代理如何设置后端服务器组的状态</h3> 
    <p>Nginx可以设置后台服务器组主机的状态，在括号内填写下列不同状态的作用</p> 
    <ul class="list"> 
     <li>down （ ） </li> 
     <li>max_fails （ ） </li> 
     <li>fail_timeout （ ） </li> 
     <li>backup （ ） </li> 
    </ul> 
    <p class="answerTitle">参考答案</p> 
    <ul class="list"> 
     <li>down：表示当前server暂时不参与负载 </li> 
     <li>max_fails：允许请求失败的次数（默认为1） </li> 
     <li>fail_timeout ：max_fails次失败后，暂停提供服务的时间 </li> 
     <li>backup：备份服务器 </li> 
    </ul> 
   </div> 
   <div> 
    <h3>2 Nginx实现TCP/UDP调度需要什么模块</h3> 
    <p class="answerTitle">参考答案</p> 
    <p>需要ngx_stream_core_module模块，使用--with-stream可以开启该模块。</p> 
   </div> 
   <div> 
    <h3>3 如何优化提升Nginx并发数量</h3> 
    <p class="answerTitle">参考答案</p> 
    <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@nginx <span class="sh_symbol">~]</span># <span class="sh_normal">vim </span><span class="sh_symbol">/</span><span class="sh_normal">usr</span><span class="sh_symbol">/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">nginx</span><span class="sh_symbol">/</span>nginx<span class="sh_symbol">.</span>conf</li><li><span class="sh_symbol">..</span> <span class="sh_symbol">..</span></li><li>events <span class="sh_cbracket">{</span></li><li>worker_connections <span class="sh_number">65535</span><span class="sh_symbol">;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//每个worker最大并发连接数</span></li><li>use epoll<span class="sh_symbol">;</span></li><li><span class="sh_cbracket">}</span></li><li><span class="sh_symbol">[</span>root@nginx <span class="sh_symbol">~]</span># <span class="sh_normal">vim </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span><span class="sh_normal">security</span><span class="sh_symbol">/</span>limits<span class="sh_symbol">.</span>conf</li><li><span class="sh_symbol">..</span> <span class="sh_symbol">..</span></li><li><span class="sh_symbol">*</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;soft    nofile  <span class="sh_number">100000</span></li><li><span class="sh_symbol">*</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hard    nofile  <span class="sh_number">100000</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@nginx ~]# vim /usr/local/nginx/nginx.conf
.. ..
events {
worker_connections 65535;				//每个worker最大并发连接数
use epoll;
}
[root@nginx ~]# vim /etc/security/limits.conf
.. ..
* 			soft    nofile  100000
* 			hard    nofile  100000
</pre></div></div> 
   </div> 
   <div> 
    <h3>4 如何使用ab对Web服务器进行压力测试</h3> 
    <p>要求：并发数为1024，总请求数为2048，测试页面为http://www.tarena.com/</p> 
    <p class="answerTitle">参考答案</p> 
    <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@localhost <span class="sh_symbol">~]</span># ab <span class="sh_symbol">-</span>c <span class="sh_number">2048</span> –n <span class="sh_number">1024</span> http<span class="sh_symbol">:</span><span class="sh_comment">//www.tarena.com/</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@localhost ~]# ab -c 2048 –n 1024 http://www.tarena.com/
</pre></div></div> 
   </div> 
   <div> 
    <h3>5 使用Nginx如何自定义404错误页面</h3> 
    <p class="answerTitle">参考答案</p> 
    <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/OPERATION/DAY03/EXERCISE/01/index_answer.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@nginx <span class="sh_symbol">~]</span># <span class="sh_normal">vim </span><span class="sh_symbol">/</span><span class="sh_normal">usr</span><span class="sh_symbol">/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">nginx</span><span class="sh_symbol">/</span><span class="sh_normal">conf</span><span class="sh_symbol">/</span>nginx<span class="sh_symbol">.</span>conf</li><li><span class="sh_symbol">..</span> <span class="sh_symbol">..</span></li><li>http <span class="sh_cbracket">{</span></li><li>fastcgi_intercept_errors on<span class="sh_symbol">;</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//错误页面重定向</span></li><li>server <span class="sh_cbracket">{</span></li><li>error_page   <span class="sh_number">404</span><span class="sh_normal">  </span><span class="sh_symbol">/</span>40x<span class="sh_symbol">.</span>html<span class="sh_symbol">;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//自定义404错误页面</span></li><li>        location <span class="sh_symbol">=</span> <span class="sh_symbol">/</span>40x<span class="sh_symbol">.</span>html <span class="sh_cbracket">{</span></li><li>            root   html<span class="sh_symbol">;</span></li><li>        <span class="sh_cbracket">}</span></li><li>error_page   <span class="sh_number">500</span> <span class="sh_number">502</span> <span class="sh_number">503</span> <span class="sh_number">504</span><span class="sh_normal">  </span><span class="sh_symbol">/</span>50x<span class="sh_symbol">.</span>html<span class="sh_symbol">;</span></li><li>        location <span class="sh_symbol">=</span> <span class="sh_symbol">/</span>50x<span class="sh_symbol">.</span>html <span class="sh_cbracket">{</span></li><li>            root   html<span class="sh_symbol">;</span></li><li>        <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@nginx ~]# vim /usr/local/nginx/conf/nginx.conf
.. ..
http {
fastcgi_intercept_errors on; 		//错误页面重定向
server {
error_page   404  /40x.html;		//自定义404错误页面
        location = /40x.html {
            root   html;
        }
error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
}
}
</pre></div></div> 
   </div> 
  </div>  
 
</body></html>