
<!-- saved from url=(0073)http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CASE</title>
    
    <script type="text/javascript" src="./day05CASE_files/jquery.min.js">
    </script>
    <script type="text/javascript" src="./day05CASE_files/jquery.snippet.js">
    </script>
    <script type="text/javascript" src="./day05CASE_files/main.js">
    </script>
    <link type="text/css" href="./day05CASE_files/index.css" rel="Stylesheet">
    <link type="text/css" href="./day05CASE_files/jquery.snippet.css" rel="Stylesheet">
  </head>
  <body>
    <div class="source_style_case">
      <a name="page_top_case" id="top_anchor">
      </a><a id="link_top" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#page_top_case">Top</a>
      <h1>NSD DBA2 DAY05</h1>
      <ol class="index">
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#case1">案例1：创建存储过程</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#case2">案例2：存储过程参数的使用</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#case3">案例3：使用循环结构</a>
        </li>
      </ol>
      <a name="case1">
      </a>
      <h2>1 案例1：创建存储过程</h2>
      <h3>1.1 问题</h3>
      <ul class="list">
        <li>存储过程名称为p1
</li>
        <li>功能显示user表中 shell是/bin/bash的用户个数
</li>
        <li>调用存储过程p1
</li>
      </ul>
      <h3>1.2 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：存储过程基本使用</p>
      <p>1）创建存储过程</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> delimiter  <span class="sh_comment">//  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//定义定界符</span></li><li>mysql<span class="sh_symbol">&gt;</span>  create procedure <span class="sh_function">say</span><span class="sh_symbol">()</span>     <span class="sh_comment">//say()随便写括号一定要有</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_symbol">*</span> from user where id<span class="sh_symbol">&lt;=</span><span class="sh_number">10</span><span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_comment">//</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.01</span> sec<span class="sh_symbol">)</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//把命令的定界符改回来，分号前有空格</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">say</span><span class="sh_symbol">();</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//调用存储过程名,在括号里面不写参数时，可以不加括号</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; delimiter  //  		//定义定界符
mysql&gt;  create procedure say()     //say()随便写括号一定要有
    -&gt; begin
    -&gt; select * from user where id&lt;=10;
    -&gt; end
    -&gt; //
Query OK, 0 rows affected (0.01 sec)
mysql&gt; delimiter ;		//把命令的定界符改回来，分号前有空格
mysql&gt; call say();	//调用存储过程名,在括号里面不写参数时，可以不加括号

</pre></div></div>
      <p>2）查看存储过程</p>
      <p>方法一：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span>  show  procedure  status<span class="sh_symbol">\</span>G<span class="sh_symbol">;</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt;  show  procedure  status\G;
</pre></div></div>
      <p>方法二：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span>  select db<span class="sh_symbol">,</span>name<span class="sh_symbol">,</span>type from mysql<span class="sh_symbol">.</span>proc where name<span class="sh_symbol">=</span> <span class="sh_string">"say"</span><span class="sh_symbol">;</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt;  select db,name,type from mysql.proc where name= "say";
</pre></div></div>
      <p>3）删除存储过程</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> drop procedure say<span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; drop procedure say;
Query OK, 0 rows affected (0.00 sec)
</pre></div></div>
      <p>4）创建存储过程名称为p1</p>
      <p>	功能显示user表中 shell是/bin/bash的用户</p>
      <p>	调用存储过程p1</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> delimiter  <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span> create procedure <span class="sh_function">p1</span><span class="sh_symbol">()</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_function">count</span><span class="sh_symbol">(</span>username<span class="sh_symbol">)</span>  from user where shell<span class="sh_symbol">=</span><span class="sh_string">"/bin/bash"</span><span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">p1</span><span class="sh_symbol">();</span></li><li><span class="sh_symbol">+-----------+</span></li><li><span class="sh_symbol">|</span> shell     <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+-----------+</span></li><li><span class="sh_symbol">|</span> <span class="sh_regexp">/bin/</span>bash <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_regexp">/bin/</span>bash <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+-----------+</span></li><li><span class="sh_number">2</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.01</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.01</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; delimiter  //
mysql&gt; create procedure p1()
    -&gt; begin
    -&gt; select count(username)  from user where shell="/bin/bash";
    -&gt; end
    -&gt; //
mysql&gt; delimiter ;
mysql&gt; call p1();
+-----------+
| shell     |
+-----------+
| /bin/bash |
| /bin/bash |
+-----------+
2 rows in set (0.01 sec)

Query OK, 0 rows affected (0.01 sec)
</pre></div></div>
      <a name="case2">
      </a>
      <h2>2 案例2：存储过程参数的使用</h2>
      <h3>2.1 问题</h3>
      <ul class="list">
        <li>创建名为p2的存储过程
</li>
        <li>可以接收用户输入shell的名字
</li>
        <li>统计user表中用户输入shell名字的个数
</li>
      </ul>
      <h3>2.2 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：存储过程参数的使用</p>
      <p>1）参数类型</p>
      <p>MySQL存储过程，共有三种参数类型IN,OUT,INOUT</p>
      <p>Create procedure  名称(</p>
      <p>类型   参数名  数据类型,</p>
      <p>类型   参数名  数据类型</p>
      <p>）</p>
      <p>in		输入参数		传递值给存储过程，必须在调用存储过程时指定，在存储过程中修改该参数的值不能；默认类型是in</p>
      <p>out		输出参数		该值可在存储过程内部被改变，并可返回</p>
      <p>inout	输入/输出参数	调用时指定，并且可被改变和返回</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span>  delimiter  <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span>  create procedure <span class="sh_function">say2</span><span class="sh_symbol">(</span><span class="sh_keyword">in</span> username <span class="sh_function">char</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">))</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span> select username<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_symbol">*</span> from user where username<span class="sh_symbol">=</span>username<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_comment">//</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">say2</span><span class="sh_symbol">(</span><span class="sh_string">"tom"</span><span class="sh_symbol">);</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt;  delimiter  //
mysql&gt;  create procedure say2(in username char(10))
    -&gt; begin
    -&gt; select username;
    -&gt; select * from user where username=username;
    -&gt; end
    -&gt; //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; delimiter ;
mysql&gt; call say2("tom");

</pre></div></div>
      <p>2）创建名为p2的存储过程，可以接收用户输入shell的名字，统计user表中用户输入shell名字的个数</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span>  delimiter  <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span>  create procedure <span class="sh_function">p2</span><span class="sh_symbol">(</span>out number int<span class="sh_symbol">)</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_function">count</span><span class="sh_symbol">(</span>username<span class="sh_symbol">)</span> into @number from user where shell<span class="sh_symbol">!=</span><span class="sh_string">"/bin/bash"</span><span class="sh_symbol">;</span> </li><li>    <span class="sh_symbol">-&gt;</span> select @number<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_comment">//</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.01</span> sec<span class="sh_symbol">)</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">p2</span><span class="sh_symbol">(</span>@number<span class="sh_symbol">);</span></li><li><span class="sh_symbol">+---------+</span></li><li><span class="sh_symbol">|</span> @number <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------+</span></li><li><span class="sh_symbol">|</span>      <span class="sh_number">38</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt;  delimiter  //
mysql&gt;  create procedure p2(out number int)
    -&gt; begin
    -&gt; select count(username) into @number from user where shell!="/bin/bash"; 
    -&gt; select @number;
    -&gt; end
    -&gt; //
Query OK, 0 rows affected (0.01 sec)
mysql&gt; delimiter ;
mysql&gt; call p2(@number);
+---------+
| @number |
+---------+
|      38 |
+---------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)
</pre></div></div>
      <a name="case3">
      </a>
      <h2>3 案例3：使用循环结构</h2>
      <h3>3.1 问题</h3>
      <ul class="list">
        <li>定义名称为p3的存储过程
</li>
        <li>用户可以自定义显示user表记录的行数
</li>
        <li>若调用时用户没有输入行数，默认显示第1条记录
</li>
      </ul>
      <h3>3.2 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：算数运算</p>
      <p>1）算数运算符号，如图-1所示：</p>
      <div class="image">
        <img src="./day05CASE_files/image001.png">
        <p>图-1</p>
      </div>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> set @z<span class="sh_symbol">=</span><span class="sh_number">1+2</span><span class="sh_symbol">;</span>select @z<span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span> @z   <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span>    <span class="sh_number">3</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li>mysql<span class="sh_symbol">&gt;</span> set @x<span class="sh_symbol">=</span><span class="sh_number">1</span><span class="sh_symbol">;</span> set @y<span class="sh_symbol">=</span><span class="sh_number">2</span><span class="sh_symbol">;</span>set @z<span class="sh_symbol">=</span>@x<span class="sh_symbol">*</span>@y<span class="sh_symbol">;</span> select @z<span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span> @z   <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span>    <span class="sh_number">2</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> set @x<span class="sh_symbol">=</span><span class="sh_number">1</span><span class="sh_symbol">;</span> set @y<span class="sh_symbol">=</span><span class="sh_number">2</span><span class="sh_symbol">;</span>set @z<span class="sh_symbol">=</span>@x<span class="sh_symbol">-</span>@y<span class="sh_symbol">;</span> select @z<span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span> @z   <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span>   <span class="sh_symbol">-</span><span class="sh_number">1</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li>mysql<span class="sh_symbol">&gt;</span> set @x<span class="sh_symbol">=</span><span class="sh_number">1</span><span class="sh_symbol">;</span> set @y<span class="sh_symbol">=</span><span class="sh_number">2</span><span class="sh_symbol">;</span>set @z<span class="sh_symbol">=</span>@<span class="sh_normal">x</span><span class="sh_symbol">/</span>@y<span class="sh_symbol">;</span> select @z<span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">+-------------+</span></li><li><span class="sh_symbol">|</span> @z           <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+-------------+</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">0.500000000</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+-------------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; set @z=1+2;select @z;
Query OK, 0 rows affected (0.00 sec)

+------+
| @z   |
+------+
|    3 |
+------+
1 row in set (0.00 sec)
mysql&gt; set @x=1; set @y=2;set @z=@x*@y; select @z;
Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

+------+
| @z   |
+------+
|    2 |
+------+
1 row in set (0.00 sec)

mysql&gt; set @x=1; set @y=2;set @z=@x-@y; select @z;
Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

+------+
| @z   |
+------+
|   -1 |
+------+
1 row in set (0.00 sec)
mysql&gt; set @x=1; set @y=2;set @z=@x/@y; select @z;
Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

+-------------+
| @z           |
+-------------+
| 0.500000000 |
+-------------+
1 row in set (0.00 sec)

</pre></div></div>
      <p>declare调用变量不需要@其他都需要</p>
      <p>调用变量时，有@符号的变量 如@x：调用的是用户自定义变量</p>
      <p>没有@符号的变量 如x：调用的是存储过程的参数变量</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span> create procedure <span class="sh_function">say5</span><span class="sh_symbol">(</span><span class="sh_keyword">in</span> bash <span class="sh_function">char</span><span class="sh_symbol">(</span><span class="sh_number">20</span><span class="sh_symbol">),</span> <span class="sh_keyword">in</span>  nologin <span class="sh_function">char</span><span class="sh_symbol">(</span><span class="sh_number">25</span><span class="sh_symbol">),</span> out x int <span class="sh_symbol">,</span> out y int<span class="sh_symbol">)</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span> declare z int <span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> set z<span class="sh_symbol">=</span><span class="sh_number">0</span><span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_function">count</span><span class="sh_symbol">(</span>username<span class="sh_symbol">)</span> into  @x from user where shell<span class="sh_symbol">=</span>bash<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_function">count</span><span class="sh_symbol">(</span>username<span class="sh_symbol">)</span> into  @y from user where shell<span class="sh_symbol">=</span>nologin<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> set z<span class="sh_symbol">=</span>@x<span class="sh_symbol">+</span>@y<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> select z<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span>  <span class="sh_comment">//</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span></li><li>mysql<span class="sh_symbol">&gt;</span>  call <span class="sh_function">say5</span><span class="sh_symbol">(</span><span class="sh_string">"/bin/bash"</span><span class="sh_symbol">,</span><span class="sh_string">"/sbin/nologin"</span><span class="sh_symbol">,</span>@x<span class="sh_symbol">,</span>@y<span class="sh_symbol">);</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span> z    <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_symbol">|</span>   <span class="sh_number">36</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; delimiter //
mysql&gt; create procedure say5(in bash char(20), in  nologin char(25), out x int , out y int)
    -&gt; begin
    -&gt; declare z int ;
    -&gt; set z=0;
    -&gt; select count(username) into  @x from user where shell=bash;
    -&gt; select count(username) into  @y from user where shell=nologin;
    -&gt; set z=@x+@y;
    -&gt; select z;
    -&gt; end
    -&gt;  //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; delimiter ;
mysql&gt;  call say5("/bin/bash","/sbin/nologin",@x,@y);
+------+
| z    |
+------+
|   36 |
+------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

</pre></div></div>
      <p>2）条件判断，数值的比较如图-2所示：</p>
      <div class="image">
        <img src="./day05CASE_files/image002.png">
        <p>图-2</p>
      </div>
      <p>逻辑比较、范围、空、非空、模糊、正则，如图-3所示：</p>
      <div class="image">
        <img src="./day05CASE_files/image003.png">
        <p>图-3</p>
      </div>
      <p>顺序结构（if判断）当“条件成立”时执行命令序列,否则，不执行任何操作</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span>  create  procedure <span class="sh_function">say6</span><span class="sh_symbol">(</span><span class="sh_keyword">in</span>  x <span class="sh_function">int</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">)</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span>  <span class="sh_keyword">if</span> x <span class="sh_symbol">&lt;=</span> <span class="sh_number">10</span> then</li><li>    <span class="sh_symbol">-&gt;</span>  select <span class="sh_symbol">*</span> from user where id <span class="sh_symbol">&lt;=</span>x<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end <span class="sh_keyword">if</span><span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_comment">//</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.01</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">say6</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//条件判断成立，等于1是否成立</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+-----------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> username <span class="sh_symbol">|</span> password <span class="sh_symbol">|</span> uid  <span class="sh_symbol">|</span> gid  <span class="sh_symbol">|</span> comment <span class="sh_symbol">|</span> homedir <span class="sh_symbol">|</span> shell     <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+-----------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> root     <span class="sh_symbol">|</span> x        <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span> root    <span class="sh_symbol">|</span> <span class="sh_regexp">/root   | /</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+-----------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">say6</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">);</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+---------------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> username <span class="sh_symbol">|</span> password <span class="sh_symbol">|</span> uid  <span class="sh_symbol">|</span> gid  <span class="sh_symbol">|</span> comment <span class="sh_symbol">|</span> homedir <span class="sh_symbol">|</span> shell         <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+---------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> root     <span class="sh_symbol">|</span> x        <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span> root    <span class="sh_symbol">|</span> <span class="sh_regexp">/root   | /</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash     <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">2</span> <span class="sh_symbol">|</span> bin      <span class="sh_symbol">|</span> x        <span class="sh_symbol">|</span>    <span class="sh_number">1</span> <span class="sh_symbol">|</span>    <span class="sh_number">1</span> <span class="sh_symbol">|</span> bin     <span class="sh_symbol">|</span> <span class="sh_regexp">/bin    | /</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+---------------+</span></li><li><span class="sh_number">2</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; delimiter //
mysql&gt;  create  procedure say6(in  x int(1) )
    -&gt; begin
    -&gt;  if x &lt;= 10 then
    -&gt;  select * from user where id &lt;=x;
    -&gt; end if;
    -&gt; end
    -&gt; //
Query OK, 0 rows affected (0.01 sec)

mysql&gt; delimiter ;
mysql&gt; call say6(1);		//条件判断成立，等于1是否成立
+----+----------+----------+------+------+---------+---------+-----------+
| id | username | password | uid  | gid  | comment | homedir | shell     |
+----+----------+----------+------+------+---------+---------+-----------+
|  1 | root     | x        |    0 |    0 | root    | /root   | /bin/bash |
+----+----------+----------+------+------+---------+---------+-----------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql&gt; call say6(2);
+----+----------+----------+------+------+---------+---------+---------------+
| id | username | password | uid  | gid  | comment | homedir | shell         |
+----+----------+----------+------+------+---------+---------+---------------+
|  1 | root     | x        |    0 |    0 | root    | /root   | /bin/bash     |
|  2 | bin      | x        |    1 |    1 | bin     | /bin    | /sbin/nologin |
+----+----------+----------+------+------+---------+---------+---------------+
2 rows in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

</pre></div></div>
      <p>3）定义名称为p3的存储过程，用户可以自定义显示user表记录的行数，若调用时用户没有输入行数，默认显示第1条记录</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_comment">//</span></li><li>mysql<span class="sh_symbol">&gt;</span> create  procedure <span class="sh_function">p3</span><span class="sh_symbol">(</span><span class="sh_keyword">in</span>  linenum <span class="sh_function">char</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">)</span> <span class="sh_symbol">)</span></li><li>    <span class="sh_symbol">-&gt;</span> begin</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_keyword">if</span> linenum is <span class="sh_keyword">null</span> then</li><li>    <span class="sh_symbol">-&gt;</span> set @linenum<span class="sh_symbol">=</span><span class="sh_number">1</span><span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_symbol">*</span> from user where id<span class="sh_symbol">=</span>@linenum<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_keyword">else</span></li><li>    <span class="sh_symbol">-&gt;</span> select linenum<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> select <span class="sh_symbol">*</span> from user where id<span class="sh_symbol">=</span>linenum<span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end <span class="sh_keyword">if</span><span class="sh_symbol">;</span></li><li>    <span class="sh_symbol">-&gt;</span> end</li><li>    <span class="sh_symbol">-&gt;</span> <span class="sh_comment">//</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> delimiter <span class="sh_symbol">;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">p3</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">);</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//不输入查看的行数</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+-----------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> username <span class="sh_symbol">|</span> password <span class="sh_symbol">|</span> uid  <span class="sh_symbol">|</span> gid  <span class="sh_symbol">|</span> comment <span class="sh_symbol">|</span> homedir <span class="sh_symbol">|</span> shell     <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+-----------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> root     <span class="sh_symbol">|</span> x        <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span> root    <span class="sh_symbol">|</span> <span class="sh_regexp">/root   | /</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+-----------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> call <span class="sh_function">p3</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">);</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//输入查看的行数</span></li><li><span class="sh_symbol">+---------+</span></li><li><span class="sh_symbol">|</span> linenum <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------+</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">3</span>       <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+---------------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> username <span class="sh_symbol">|</span> password <span class="sh_symbol">|</span> uid  <span class="sh_symbol">|</span> gid  <span class="sh_symbol">|</span> comment <span class="sh_symbol">|</span> homedir <span class="sh_symbol">|</span> shell         <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+---------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">3</span> <span class="sh_symbol">|</span> daemon   <span class="sh_symbol">|</span> x        <span class="sh_symbol">|</span>    <span class="sh_number">2</span> <span class="sh_symbol">|</span>    <span class="sh_number">2</span> <span class="sh_symbol">|</span> daemon  <span class="sh_symbol">|</span> <span class="sh_regexp">/sbin   | /</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+----------+----------+------+------+---------+---------+---------------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; delimiter //
mysql&gt; create  procedure p3(in  linenum char(10) )
    -&gt; begin
    -&gt; if linenum is null then
    -&gt; set @linenum=1;
    -&gt; select * from user where id=@linenum;
    -&gt; else
    -&gt; select linenum;
    -&gt; select * from user where id=linenum;
    -&gt; end if;
    -&gt; end
    -&gt; //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; delimiter ;
mysql&gt; call p3(null);		//不输入查看的行数
+----+----------+----------+------+------+---------+---------+-----------+
| id | username | password | uid  | gid  | comment | homedir | shell     |
+----+----------+----------+------+------+---------+---------+-----------+
|  1 | root     | x        |    0 |    0 | root    | /root   | /bin/bash |
+----+----------+----------+------+------+---------+---------+-----------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

mysql&gt; call p3(3);		//输入查看的行数
+---------+
| linenum |
+---------+
| 3       |
+---------+
1 row in set (0.00 sec)

+----+----------+----------+------+------+---------+---------+---------------+
| id | username | password | uid  | gid  | comment | homedir | shell         |
+----+----------+----------+------+------+---------+---------+---------------+
|  3 | daemon   | x        |    2 |    2 | daemon  | /sbin   | /sbin/nologin |
+----+----------+----------+------+------+---------+---------+---------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)
</pre></div></div>
    </div>
  
</body></html>