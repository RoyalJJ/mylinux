
<!-- saved from url=(0074)http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CASE</title>
    
    <script type="text/javascript" src="./1CASE_files/jquery.min.js">
    </script>
    <script type="text/javascript" src="./1CASE_files/jquery.snippet.js">
    </script>
    <script type="text/javascript" src="./1CASE_files/main.js">
    </script>
    <link type="text/css" href="./1CASE_files/index.css" rel="Stylesheet">
    <link type="text/css" href="./1CASE_files/jquery.snippet.css" rel="Stylesheet">
  </head>
  <body>
    <div class="source_style_case">
      <a name="page_top_case" id="top_anchor">
      </a><a id="link_top" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#page_top_case">Top</a>
      <h1>NSD CLOUD DAY01</h1>
      <ol class="index">
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#case1">案例1：virsh基本管理操作</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#case2">案例2：qemu-img基本操作管理</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#case3">案例3：创建一个虚拟网络</a>
        </li>
      </ol>
      <a name="case1">
      </a>
      <h2>1 案例1：virsh基本管理操作</h2>
      <h3>1.1 问题</h3>
      <p>本案例要求熟悉virsh的基本操作，可以熟练运用：</p>
      <ul class="list">
        <li>列出当前正在运行的虚拟机
</li>
        <li>查看虚拟机的信息
</li>
        <li>管理虚拟机
</li>
        <li>设置虚拟机开机自动运行
</li>
      </ul>
      <h3>1.2 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：virsh基本操作</p>
      <p>1）列出当前正在运行的虚拟机</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style=""><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li> <span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh list </li><li> Id    Name                           State</li><li><span class="sh_symbol">----------------------------------------------------</span></li><li> <span class="sh_number">1</span>     node1                          running</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;"> [root@room9pc01 ~]# virsh list 
 Id    Name                           State
----------------------------------------------------
 1     node1                          running
</pre></div></div>
      <p>2）查看虚拟机的信息</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh dominfo node1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//查看node1的信息</span></li><li>Id<span class="sh_symbol">:</span>             <span class="sh_number">1</span></li><li>Name<span class="sh_symbol">:</span>           node1</li><li>UUID<span class="sh_symbol">:</span>           20e15d2f<span class="sh_symbol">-</span>ea30<span class="sh_symbol">-</span>4aa3<span class="sh_symbol">-</span>96dc<span class="sh_symbol">-</span>91aab6283b10</li><li>OS Type<span class="sh_symbol">:</span>        hvm</li><li>State<span class="sh_symbol">:</span>          running</li><li><span class="sh_function">CPU</span><span class="sh_symbol">(</span>s<span class="sh_symbol">):</span>         <span class="sh_number">2</span></li><li>CPU time<span class="sh_symbol">:</span>       <span class="sh_number">92</span><span class="sh_symbol">.</span>8s</li><li>Max memory<span class="sh_symbol">:</span>     <span class="sh_number">2048000</span> KiB</li><li>Used memory<span class="sh_symbol">:</span>    <span class="sh_number">2048000</span> KiB</li><li>Persistent<span class="sh_symbol">:</span>     yes</li><li>Autostart<span class="sh_symbol">:</span>      disable</li><li>Managed save<span class="sh_symbol">:</span>   no</li><li>Security model<span class="sh_symbol">:</span> none</li><li>Security DOI<span class="sh_symbol">:</span>   <span class="sh_number">0</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh dominfo node1					//查看node1的信息
Id:             1
Name:           node1
UUID:           20e15d2f-ea30-4aa3-96dc-91aab6283b10
OS Type:        hvm
State:          running
CPU(s):         2
CPU time:       92.8s
Max memory:     2048000 KiB
Used memory:    2048000 KiB
Persistent:     yes
Autostart:      disable
Managed save:   no
Security model: none
Security DOI:   0
</pre></div></div>
      <p class="number">步骤二：管理虚拟机</p>
      <p>1）启动虚拟机</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh start node1</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh start node1
</pre></div></div>
      <p>2）重启虚拟机</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh reboot node1</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh reboot node1
</pre></div></div>
      <p>3）强制关闭虚拟机</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh destroy node1</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh destroy node1
</pre></div></div>
      <p>4）设置虚拟机开机自动运行</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh autostart node1</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh autostart node1
</pre></div></div>
      <a name="case2">
      </a>
      <h2>2 案例2：qemu-img基本操作管理</h2>
      <h3>2.1 问题</h3>
      <p>本案例要求：</p>
      <ul class="list">
        <li>创建一个新的镜像盘文件
</li>
        <li>使用后端模板文件创建一个新的镜像盘文件
</li>
        <li>查看镜像盘文件的信息
</li>
      </ul>
      <h3>2.2 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：创建一个新的镜像盘文件</p>
      <p>qemu-img命令格式：qemu-img  命令  参数   块文件名称   大小</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># qemu<span class="sh_symbol">-</span>img create   <span class="sh_symbol">-</span>f qcow2 disk<span class="sh_symbol">.</span>img 50G    <span class="sh_comment">//qcow2为创建的格式</span></li><li>Formatting <span class="sh_string">'disk.img'</span><span class="sh_symbol">,</span> fmt<span class="sh_symbol">=</span>qcow2 size<span class="sh_symbol">=</span><span class="sh_number">53687091200</span> encryption<span class="sh_symbol">=</span>off cluster_size<span class="sh_symbol">=</span><span class="sh_number">65536</span> lazy_refcounts<span class="sh_symbol">=</span>off</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# qemu-img create   -f qcow2 disk.img 50G    //qcow2为创建的格式
Formatting 'disk.img', fmt=qcow2 size=53687091200 encryption=off cluster_size=65536 lazy_refcounts=off
</pre></div></div>
      <p>2）使用后端模板文件创建一个新的镜像盘文件</p>
      <p>备注：-b使用后端模板文件</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># qemu<span class="sh_symbol">-</span>img create <span class="sh_symbol">-</span>b disk<span class="sh_symbol">.</span>img <span class="sh_symbol">-</span>f qcow2 disk1<span class="sh_symbol">.</span>img</li><li>Formatting <span class="sh_string">'disk1.img'</span><span class="sh_symbol">,</span> fmt<span class="sh_symbol">=</span>qcow2 size<span class="sh_symbol">=</span><span class="sh_number">53687091200</span> backing_file<span class="sh_symbol">=</span><span class="sh_string">'disk.img'</span> encryption<span class="sh_symbol">=</span>off cluster_size<span class="sh_symbol">=</span><span class="sh_number">65536</span> lazy_refcounts<span class="sh_symbol">=</span>off</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# qemu-img create -b disk.img -f qcow2 disk1.img
Formatting 'disk1.img', fmt=qcow2 size=53687091200 backing_file='disk.img' encryption=off cluster_size=65536 lazy_refcounts=off
</pre></div></div>
      <p>3）使用后端模板文件创建一个16G的镜像盘文件</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li> <span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># qemu<span class="sh_symbol">-</span>img create <span class="sh_symbol">-</span>b disk<span class="sh_symbol">.</span>img <span class="sh_symbol">-</span>f qcow2 disk2<span class="sh_symbol">.</span>img  16G</li><li>Formatting <span class="sh_string">'disk1.img'</span><span class="sh_symbol">,</span> fmt<span class="sh_symbol">=</span>qcow2 size<span class="sh_symbol">=</span><span class="sh_number">53687091200</span> backing_file<span class="sh_symbol">=</span><span class="sh_string">'disk.img'</span> encryption<span class="sh_symbol">=</span>off cluster_size<span class="sh_symbol">=</span><span class="sh_number">65536</span> lazy_refcounts<span class="sh_symbol">=</span>off</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;"> [root@room9pc01 ~]# qemu-img create -b disk.img -f qcow2 disk2.img  16G
Formatting 'disk1.img', fmt=qcow2 size=53687091200 backing_file='disk.img' encryption=off cluster_size=65536 lazy_refcounts=off

</pre></div></div>
      <p class="number">步骤二：查看镜像文件的信息</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># qemu<span class="sh_symbol">-</span>img  info disk1<span class="sh_symbol">.</span>img </li><li>image<span class="sh_symbol">:</span> disk<span class="sh_symbol">.</span>img</li><li>file format<span class="sh_symbol">:</span> qcow2</li><li>virtual size<span class="sh_symbol">:</span> 50<span class="sh_function">G</span> <span class="sh_symbol">(</span><span class="sh_number">53687091200</span> bytes<span class="sh_symbol">)</span></li><li>disk size<span class="sh_symbol">:</span> 196K</li><li>cluster_size<span class="sh_symbol">:</span> <span class="sh_number">65536</span></li><li>Format specific information<span class="sh_symbol">:</span></li><li>    compat<span class="sh_symbol">:</span> <span class="sh_number">1.1</span></li><li>    lazy refcounts<span class="sh_symbol">:</span> <span class="sh_keyword">false</span> <span class="sh_symbol">|</span> help_topic   <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> innodb_index_stats        <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> innodb_table_stats        <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> ndb_binlog_index          <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> plugin                     <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> proc                       <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> procs_priv                 <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> proxies_priv               <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> server_cost                <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> servers                    <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> slave_master_info         <span class="sh_symbol">|</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# qemu-img  info disk1.img 
image: disk.img
file format: qcow2
virtual size: 50G (53687091200 bytes)
disk size: 196K
cluster_size: 65536
Format specific information:
    compat: 1.1
    lazy refcounts: false | help_topic   |
| innodb_index_stats        |
| innodb_table_stats        |
| ndb_binlog_index          |
| plugin                     |
| proc                       |
| procs_priv                 |
| proxies_priv               |
| server_cost                |
| servers                    |
| slave_master_info         |
</pre></div></div>
      <a name="case3">
      </a>
      <h2>3 案例3：创建一个虚拟网络</h2>
      <h3>3.1 问题</h3>
      <p>创建一个虚拟网络，为之后的自定义安装虚拟机做准备：</p>
      <ul class="list">
        <li>创建一个名为vbr的虚拟网络
</li>
        <li>设置vbr的ip为192.168.1.254
</li>
        <li>配置vbr虚拟网络的dhcp分配地址范围100-200
</li>
        <li>启动vbr虚拟网络并用ifconfig验证
</li>
        <li>设置vbr虚拟网络开机自启动
</li>
      </ul>
      <h3>3.2 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：创建一个名为vbr的虚拟网络</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># <span class="sh_normal">vim  </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span><span class="sh_normal">libvirt</span><span class="sh_symbol">/</span><span class="sh_normal">qemu</span><span class="sh_symbol">/</span><span class="sh_normal">networks</span><span class="sh_symbol">/</span>vbr<span class="sh_symbol">.</span>xml</li><li><span class="sh_symbol">&lt;</span>network<span class="sh_symbol">&gt;</span></li><li>  <span class="sh_symbol">&lt;</span>name<span class="sh_symbol">&gt;</span>vbr<span class="sh_symbol">&lt;</span><span class="sh_regexp">/name&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/</span><span class="sh_symbol">/</span>vbr为虚拟网络的名字</li><li>  <span class="sh_symbol">&lt;</span>bridge name<span class="sh_symbol">=</span><span class="sh_string">"vbr"</span><span class="sh_symbol">/&gt;</span></li><li>  <span class="sh_symbol">&lt;</span>forward mode<span class="sh_symbol">=</span><span class="sh_string">"nat"</span><span class="sh_symbol">/&gt;</span></li><li>  <span class="sh_symbol">&lt;</span>ip address<span class="sh_symbol">=</span><span class="sh_string">"192.168.1.254"</span> netmask<span class="sh_symbol">=</span><span class="sh_string">"255.255.255.0"</span><span class="sh_symbol">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//ip为192.168.1.254</span></li><li>    <span class="sh_symbol">&lt;</span>dhcp<span class="sh_symbol">&gt;</span></li><li>      <span class="sh_symbol">&lt;</span>range start<span class="sh_symbol">=</span><span class="sh_string">"192.168.1.100"</span> end<span class="sh_symbol">=</span><span class="sh_string">"192.168.1.200"</span><span class="sh_regexp">/&gt;     /</span><span class="sh_symbol">/</span>ip范围是<span class="sh_number">100-200</span></li><li>    <span class="sh_symbol">&lt;/</span>dhcp<span class="sh_symbol">&gt;</span></li><li>  <span class="sh_symbol">&lt;/</span>ip<span class="sh_symbol">&gt;</span></li><li><span class="sh_symbol">&lt;/</span>network<span class="sh_symbol">&gt;</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# vim  /etc/libvirt/qemu/networks/vbr.xml
&lt;network&gt;
  &lt;name&gt;vbr&lt;/name&gt;				//vbr为虚拟网络的名字
  &lt;bridge name="vbr"/&gt;
  &lt;forward mode="nat"/&gt;
  &lt;ip address="192.168.1.254" netmask="255.255.255.0"&gt;		//ip为192.168.1.254
    &lt;dhcp&gt;
      &lt;range start="192.168.1.100" end="192.168.1.200"/&gt;     //ip范围是100-200
    &lt;/dhcp&gt;
  &lt;/ip&gt;
&lt;/network&gt;
</pre></div></div>
      <p class="number">步骤二：启动vbr虚拟网络并用ifconfig验证</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh net<span class="sh_symbol">-</span>define vbr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//定义vbr虚拟网络</span></li><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh net<span class="sh_symbol">-</span>start vbr      <span class="sh_comment">//启动vbr虚拟网络</span></li><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># ifconfig&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//igconfig验证 </span></li><li>vbr<span class="sh_symbol">:</span> flags<span class="sh_symbol">=</span><span class="sh_number">4163</span><span class="sh_symbol">&lt;</span>UP<span class="sh_symbol">,</span>BROADCAST<span class="sh_symbol">,</span>RUNNING<span class="sh_symbol">,</span>MULTICAST<span class="sh_symbol">&gt;</span>  mtu <span class="sh_number">1500</span></li><li>        inet <span class="sh_number">192.168.1.254</span>  netmask <span class="sh_number">255.255.255.0</span>  broadcast <span class="sh_number">192.168.1.255</span></li><li>        ether <span class="sh_number">52</span><span class="sh_symbol">:</span><span class="sh_number">54</span><span class="sh_symbol">:</span><span class="sh_number">00</span><span class="sh_symbol">:</span>b7<span class="sh_symbol">:</span>1c<span class="sh_symbol">:</span><span class="sh_number">10</span>  txqueuelen <span class="sh_number">1000</span>  <span class="sh_symbol">(</span>Ethernet<span class="sh_symbol">)</span></li><li>        RX packets <span class="sh_number">2460</span>  bytes <span class="sh_number">176958</span> <span class="sh_symbol">(</span><span class="sh_number">172.8</span> KiB<span class="sh_symbol">)</span></li><li>        RX errors <span class="sh_number">0</span>  dropped <span class="sh_number">0</span>  overruns <span class="sh_number">0</span>  frame <span class="sh_number">0</span></li><li>        TX packets <span class="sh_number">1948</span>  bytes <span class="sh_number">532542</span> <span class="sh_symbol">(</span><span class="sh_number">520.0</span> KiB<span class="sh_symbol">)</span></li><li>        TX errors <span class="sh_number">0</span>  dropped <span class="sh_number">0</span> overruns <span class="sh_number">0</span>  carrier <span class="sh_number">0</span>  collisions <span class="sh_number">0</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh net-define vbr		//定义vbr虚拟网络
[root@room9pc01 ~]# virsh net-start vbr      //启动vbr虚拟网络
[root@room9pc01 ~]# ifconfig				//igconfig验证 
vbr: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.254  netmask 255.255.255.0  broadcast 192.168.1.255
        ether 52:54:00:b7:1c:10  txqueuelen 1000  (Ethernet)
        RX packets 2460  bytes 176958 (172.8 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1948  bytes 532542 (520.0 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</pre></div></div>
      <p class="number">步骤三：设置vbr虚拟网络开机自启动</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/VIP/NSDVN201805/CLOUD/DAY01/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@room9pc01 <span class="sh_symbol">~]</span># virsh net<span class="sh_symbol">-</span>autostart vbr</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@room9pc01 ~]# virsh net-autostart vbr
</pre></div></div>
    </div>
  
</body></html>